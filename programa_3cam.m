clear all
r=zeros(49,1); freq=zeros(49,1);
p=3;
c=1;
n=100;
for i=1:49
h=10e-3;
r(i)=i/50;
esp_piezo=r(i)*h/2; esp_al=h-2*esp_piezo;
freq(i)=timo_function(esp_al,esp_piezo,n,p,c);
end

x=[0.019134342940889115
0.029525158768930165
0.03922325354176845
0.0496140693698095
0.06277576941866148
0.07455202735710798
0.08632828529555447
0.09948998534440645
0.1140371275036639
0.12789154860771862
0.14174596971177333
0.15560039081582805
0.16945481191988276
0.18330923302393748
0.19524767953102096
0.20814823086049272
0.22140889106008793
0.23664875427454812
0.2518886174890083
0.2671284807034685
0.2823683439179287
0.2984777723497802
0.312848070346849
0.3280879335613092
0.3433277967757694
0.35856765999022966
0.3738075232046898
0.38904738641914993
0.4052803727781744
0.4195271128480703
0.43476697606253056
0.4500068392769907
0.46524670249145095
0.4804865657059111
0.49572642892037133
0.5109662921348315
0.5262061553492916
0.5414460185637519
0.556685881778212
0.5719257449926722
0.5880351734245237
0.6024054714215926
0.6176453346360528
0.632885197850513
0.6481250610649731
0.6633649242794333
0.6786047874938935
0.6938446507083537
0.7090845139228139
0.724324377137274
0.7395642403517343
0.7548041035661944
0.7700439667806546
0.784591108939912
0.7998309721543723
0.8157635564240352
0.8310034196384953
0.8462432828529556
0.8614831460674158
0.876723009281876
0.8919628724963361
0.9080723009281876
0.9224425989252564
0.9376824621397167
0.9529223253541769
0.968162188568637
0.9834020517830971];

y=[799.8906474736132
791.2251658972319
782.9621616935613
774.3144126429842
764.9833537126532
756.3636778944041
747.6062494039476
738.1805168188994
729.1135640632391
720.5218220912152
712.2474622759573
703.8144113823164
695.4607060278672
686.908636825439
680.2223869396363
672.9910141692982
666.445249777636
658.9985297960798
651.5878759687016
644.3214867580352
636.946899084835
629.5553609605633
623.3879068263077
617.4920314744045
611.5600899683233
605.6401705136348
599.6601408019828
593.2954054457659
588.457782301331
583.3790947592142
578.2766747992266
573.6791809977306
568.9374225795226
563.8710687737128
559.8866995932424
555.3613381001023
551.0523735320301
547.2723792252348
543.263965941979
539.813670883814
535.7462299696126
531.8948350577793
528.5888046163262
525.3618246735933
522.0266462683264
518.7275340172375
515.380333560578
511.9971153964517
509.4433218849964
506.57700348404325
503.8910158539799
501.13289591556065
498.4469082854974
496.11711313028303
493.4164039980771
490.82173924544315
488.60461161969357
486.35141783976593
483.95395944312645
481.6286333548429
479.0628662387062
476.8777835321237
475.22971355683995
473.3011151645141
471.37251677218836
469.40785222568456
467.5513861417147];

figure(1)
plot(r,freq,'k')
hold on
plot(x,y,'ro')
set(gca,'fontsize',18)
legend({'$\omega_{11}$','Ansys 2D'},'interpreter','LaTex');
xlabel('Thickness ratio $r=2h^{p}/h$','interpreter','LaTex');
ylabel('First natural frequency [Hz]','interpreter','LaTex')
